# 矩阵快速幂

## 基本介绍

### 如何计算矩阵快速幂？

> 思想基础：**二分**

我们先看看整数的幂如果快速计算，以 $10^{75}$ 如何计算？

![IMG_04A672C83137-1](https://p.ipic.vip/ys3jen.jpg)

好了，那矩阵的快速幂怎么计算呢？

![IMG_9D0C97A067BC-1](https://p.ipic.vip/nbnnj5.jpg)

### 应用场景

矩阵快速幂算法可以利用矩阵乘法的性质来在 $O(log N)$ 的时间复杂度内计算出一个具有 **k 阶常系数线性递推关系** 的数列第 n 项的方法。

> **k 阶常系数线性递推关系**：对于数列 $\left\{F_n\right\}$ ，数列中的各个项均满足下面这个递推关系：
> $$
> \begin{equation}
> F_n=a_1 \times F_{n-1}+a_2 \times F_{n-2}+\ldots+a_k \times F_{n-k}(n>k)
> \end{equation}
> $$
> 则称数列 $\left\{F_n\right\}$ 具有 **k 阶常系数线性递推关系**。

经典的斐波那契数列 $F(n) = F(n-1)+F(n-2),F(1)=1,F(2)=1$ 就是经典的二阶递推关系。

## 经典题目

### 题目一：斐波那契数列的矩阵快速幂解法

斐波那契数列 $F(n) = F(n-1)+F(n-2),F(1)=1,F(2)=1$ 的矩阵快速幂解法。

![IMG_5D27ABCB2CB7-1](https://p.ipic.vip/qivrkh.jpg)

### 题目二：牛数量

第一年农场有 1 只成熟的母牛 A，往后的每年：

- 每一只成熟的母牛都会生一只母牛
- 每一只新出生的母牛都会在出生的第三年成熟
- 每一只母牛永远不会死

返回 N 年后牛的数量

#### 解决方法

列出例子，求递推方程：

![IMG_5B81AAF0E3B8-1](https://p.ipic.vip/uhmfnj.jpg)

该问题是一个 3 阶递推问题。先求出递推矩阵 A：

![IMG_5040051F2F35-1](https://p.ipic.vip/luah04.jpg)

### 题目三：达标字符串数量

给定一个数 N，想象只由 0 和 1 两种字符，组成的所有长度为 N 的字符串。如果某个字符串，如何 0 字符的左边都紧挨着 1，认为这个字符串达标，返回有多少个达标的字符串。

#### 解决方法

这就是前两项为 1，2 的斐波那契数列。

怎么推导呢？

假设一个函数 `f(i)` 计算的是，第一个位置是 1，剩下 i 个位置填完后达标的字符串的个数。

![IMG_E6DDC1A502D5-1](https://p.ipic.vip/9y28kx.jpg)









